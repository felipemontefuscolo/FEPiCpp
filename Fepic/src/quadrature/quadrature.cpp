#include "quadrature.hpp"
#include "../mesh/fepic_tags.hpp"
#include <cstdio>
#include "../util/assert.hpp"
#include <cmath>


Quadrature* Quadrature::create(ECellClass cc)
{
  
  if (cc & POINT)
    return new Quadrature_POINT;
  
  if (cc & EDGE)
    return new Quadrature_EDGE;
  
  if (cc & TRIANGLE)
    return new Quadrature_TRIANGLE;
  
  if (cc & QUADRANGLE)
    return new Quadrature_QUADRANGLE;
    
  if (cc & TETRAHEDRON)
    return new Quadrature_TETRAHEDRON;
    
  if (cc & HEXAHEDRON)
    return new Quadrature_HEXAHEDRON;
    
  FEPIC_CHECK(false, "invalid or not supported cell type", std::invalid_argument);
  return NULL;
}


Quadrature* Quadrature::create(ECellType ct)
{
  return Quadrature::create(ctype2cclass(ct));
}

/*
 * @param n order.
 * @param dim hypercube's dimension.
 * @param[out] points qdrts points.
 * @param[out] weights qdrts weights.
 * @param[out] n_points num of points.
 */ 
void _getQuadrPtsHypercube(int n, int dim, Real *points, Real *weights, int &n_points)
{
  
  int  n_points_1d;
  Real points_1d [Quadrature_EDGE::MaxNumQPoints];
  Real weights_1d[Quadrature_EDGE::MaxNumQPoints];
  
  // integra exatamente polinomios de grau (num_pts*2 - 1)
  switch (n)
  {
    case 0 ... 1:
    {
      n_points_1d = 1;
      points_1d[0] = 0.0L; weights_1d[0] = 2.000000000000000000L;
    }
    break;

    case 2 ... 3:
    {
      n_points_1d = 2;
      points_1d[0] = -5.773502691896258e-1L; weights_1d[0] = 1.000000000000000000L;
      points_1d[1] = +5.773502691896258e-1L; weights_1d[1] = 1.000000000000000000L;
    }
    break;

    case 4 ... 5:
    {
      n_points_1d = 3;
      points_1d[0] = 0.000000000000000000L; weights_1d[0] = 8.888888888888889e-1L;
      points_1d[1] = +7.745966692414834e-1; weights_1d[1] = 5.555555555555556e-1L;
      points_1d[2] = -7.745966692414834e-1; weights_1d[2] = 5.555555555555556e-1L;
    }
    break;

    case 6 ... 7:
    {
      n_points_1d = 4;
      points_1d[0] = +3.399810435848563e-1L; weights_1d[0] = 6.521451548625462e-1L;
      points_1d[1] = -3.399810435848563e-1L; weights_1d[1] = 6.521451548625462e-1L;
      points_1d[2] = +8.611363115940526e-1L; weights_1d[2] = 3.478548451374539e-1L;
      points_1d[3] = -8.611363115940526e-1L; weights_1d[3] = 3.478548451374539e-1L;
    }
    break;

    case 8 ... 9:
    {
      n_points_1d = 5;
      points_1d[0] = +0.000000000000000000L; weights_1d[0] = 5.688888888888889e-1L;
      points_1d[1] = +5.384693101056831e-1L; weights_1d[1] = 4.786286704993665e-1L;
      points_1d[2] = -5.384693101056831e-1L; weights_1d[2] = 4.786286704993665e-1L;
      points_1d[3] = +9.06179845938664e-1L;  weights_1d[3] = 2.369268850561891e-1L;
      points_1d[4] = -9.06179845938664e-1L;  weights_1d[4] = 2.369268850561891e-1L;
    }
    break;
    
    default:
    {
      FEPIC_CHECK(false, "invalid or not supported quadrature order", std::invalid_argument);
    }      
  }
  
  n_points = pow(n_points_1d, dim);
  
  int i[3] = {0,0,0}; // max dim = 3
  
  for (int s = 0; s < n_points; ++s)
  {
    *weights = 1.0;
    for (int d = 0; d < dim; ++d)
    {
      *points++ = points_1d[ i[d] ];
      
      *weights *= weights_1d[ i[d] ];
    }
    ++weights;
    
    for (int k = 0; k < dim; ++k)
    {
      ++i[k];
      if (i[k] != n_points_1d)
        break;
      else
        i[k] = 0;
    }
    
  }
  
  
};
 
 
 

template<>
void Quadrature_POINT::setOrder(int n)
{
  this->_order = n;
  _points[0][0] = 0;
  _weights[0] = 1.0L;
  _n_points = 1;
}

 
template<> 
void Quadrature_EDGE::setOrder(int n)
{
  this->_order = n;
  _getQuadrPtsHypercube(n, Dim, _points[0], _weights, _n_points);
}

template<>
void Quadrature_QUADRANGLE::setOrder(int n)
{
  this->_order = n;
  _getQuadrPtsHypercube(n, Dim, _points[0], _weights, _n_points);
}

template<>
void Quadrature_HEXAHEDRON::setOrder(int n)
{
  this->_order = n;
  _getQuadrPtsHypercube(n, Dim, _points[0], _weights, _n_points);
}

template<>
void Quadrature_TRIANGLE::setOrder(int n)
{
  this->_order = n;
  switch (n)
  {
    case 0 ... 1:
    {
      _n_points = 1;
      _points[0][0] = 0.333333333333333333L; _points[0][1] = 0.333333333333333333L; _weights[0] = 1.000000000000000000L;
    }
    break;

    case 2:
    {
      _n_points = 3;
      _points[0][0] = 0.166666666666666667L; _points[0][1] = 0.166666666666666667L;  _weights[0] = 0.333333333333333333L;
      _points[1][0] = 0.166666666666666667L; _points[1][1] = 0.666666666666666667L;  _weights[1] = 0.333333333333333333L;
      _points[2][0] = 0.666666666666666667L; _points[2][1] = 0.166666666666666667L;  _weights[2] = 0.333333333333333333L;
    }
    break;

    case 3:
    {
      _n_points = 6;
      _points[0][0] = 0.445948490915964886L; _points[0][1] = 0.445948490915964886L;  _weights[0] = 0.223381589678011466L;
      _points[1][0] = 0.445948490915964886L; _points[1][1] = 0.108103018168070227L;  _weights[1] = 0.223381589678011466L;
      _points[2][0] = 0.108103018168070227L; _points[2][1] = 0.445948490915964886L;  _weights[2] = 0.223381589678011466L;
      _points[3][0] = 0.091576213509770743L; _points[3][1] = 0.091576213509770743L;  _weights[3] = 0.109951743655321868L;
      _points[4][0] = 0.091576213509770743L; _points[4][1] = 0.816847572980458513L;  _weights[4] = 0.109951743655321868L;
      _points[5][0] = 0.816847572980458513L; _points[5][1] = 0.091576213509770743L;  _weights[5] = 0.109951743655321868L;
    }
    break;

    case 4 ... 5:
    {
      _n_points = 7;
      _points[0][0] = 0.101286507323456339L; _points[0][1] = 0.101286507323456339L;  _weights[0] = 0.125939180544827153L;
      _points[1][0] = 0.101286507323456339L; _points[1][1] = 0.797426985353087322L;  _weights[1] = 0.125939180544827153L;
      _points[2][0] = 0.797426985353087322L; _points[2][1] = 0.101286507323456339L;  _weights[2] = 0.125939180544827153L;
      _points[3][0] = 0.470142064105115090L; _points[3][1] = 0.470142064105115090L;  _weights[3] = 0.132394152788506181L;
      _points[4][0] = 0.470142064105115090L; _points[4][1] = 0.059715871789769820L;  _weights[4] = 0.132394152788506181L;
      _points[5][0] = 0.059715871789769820L; _points[5][1] = 0.470142064105115090L;  _weights[5] = 0.132394152788506181L;
      _points[6][0] = 0.333333333333333333L; _points[6][1] = 0.333333333333333333L;  _weights[6] = 0.225000000000000000L;
    }
    break;

    case 6:
    {
      _n_points = 12;
      _points[0][0] = 0.063089014491502228L; _points[0][1] = 0.063089014491502228L;  _weights[0] = 0.050844906370206817L;
      _points[1][0] = 0.063089014491502228L; _points[1][1] = 0.873821971016995543L;  _weights[1] = 0.050844906370206817L;
      _points[2][0] = 0.873821971016995543L; _points[2][1] = 0.063089014491502228L;  _weights[2] = 0.050844906370206817L;
      _points[3][0] = 0.249286745170910421L; _points[3][1] = 0.249286745170910421L;  _weights[3] = 0.116786275726379366L;
      _points[4][0] = 0.249286745170910421L; _points[4][1] = 0.501426509658179157L;  _weights[4] = 0.116786275726379366L;
      _points[5][0] = 0.501426509658179157L; _points[5][1] = 0.249286745170910421L;  _weights[5] = 0.116786275726379366L;
      _points[6][0] = 0.053145049844816947L; _points[6][1] = 0.310352451033784405L;  _weights[6] = 0.082851075618373575L;
      _points[7][0] = 0.053145049844816947L; _points[7][1] = 0.636502499121398647L;  _weights[7] = 0.082851075618373575L;
      _points[8][0] = 0.310352451033784405L; _points[8][1] = 0.053145049844816947L;  _weights[8] = 0.082851075618373575L;
      _points[9][0] = 0.310352451033784405L; _points[9][1] = 0.636502499121398647L;  _weights[9] = 0.082851075618373575L;
      _points[10][0] = 0.636502499121398647L; _points[10][1] = 0.053145049844816947L;  _weights[10] = 0.082851075618373575L;
      _points[11][0] = 0.636502499121398647L; _points[11][1] = 0.310352451033784405L;  _weights[11] = 0.082851075618373575L;
    }
    break;

    case 7:
    {
      _n_points = 15;
      _points[0][0] = 0.028263924156076340L; _points[0][1] = 0.028263924156076340L;  _weights[0] = 0.013533862515665562L;
      _points[1][0] = 0.028263924156076340L; _points[1][1] = 0.943472151687847320L;  _weights[1] = 0.013533862515665562L;
      _points[2][0] = 0.943472151687847320L; _points[2][1] = 0.028263924156076340L;  _weights[2] = 0.013533862515665562L;
      _points[3][0] = 0.474311323267222575L; _points[3][1] = 0.474311323267222575L;  _weights[3] = 0.078951254432010981L;
      _points[4][0] = 0.474311323267222575L; _points[4][1] = 0.051377353465554849L;  _weights[4] = 0.078951254432010981L;
      _points[5][0] = 0.051377353465554849L; _points[5][1] = 0.474311323267222575L;  _weights[5] = 0.078951254432010981L;
      _points[6][0] = 0.241143325849848810L; _points[6][1] = 0.241143325849848810L;  _weights[6] = 0.128607927818906075L;
      _points[7][0] = 0.241143325849848810L; _points[7][1] = 0.517713348300302379L;  _weights[7] = 0.128607927818906075L;
      _points[8][0] = 0.517713348300302379L; _points[8][1] = 0.241143325849848810L;  _weights[8] = 0.128607927818906075L;
      _points[9][0] = 0.761222748024523800L; _points[9][1] = 0.046270877798808911L;  _weights[9] = 0.056120144283375358L;
      _points[10][0] = 0.761222748024523800L; _points[10][1] = 0.192506374176667289L;  _weights[10] = 0.056120144283375358L;
      _points[11][0] = 0.046270877798808911L; _points[11][1] = 0.761222748024523800L;  _weights[11] = 0.056120144283375358L;
      _points[12][0] = 0.046270877798808911L; _points[12][1] = 0.192506374176667289L;  _weights[12] = 0.056120144283375358L;
      _points[13][0] = 0.192506374176667289L; _points[13][1] = 0.761222748024523800L;  _weights[13] = 0.056120144283375358L;
      _points[14][0] = 0.192506374176667289L; _points[14][1] = 0.046270877798808911L;  _weights[14] = 0.056120144283375358L;
    }
    break;

    case 8:
    {
      _n_points = 16;
      _points[0][0] = 0.333333333333333333L; _points[0][1] = 0.333333333333333333L;  _weights[0] = 0.144315607677787168L;
      _points[1][0] = 0.170569307751760207L; _points[1][1] = 0.170569307751760207L;  _weights[1] = 0.103217370534718250L;
      _points[2][0] = 0.170569307751760207L; _points[2][1] = 0.658861384496479587L;  _weights[2] = 0.103217370534718250L;
      _points[3][0] = 0.658861384496479587L; _points[3][1] = 0.170569307751760207L;  _weights[3] = 0.103217370534718250L;
      _points[4][0] = 0.050547228317030975L; _points[4][1] = 0.050547228317030975L;  _weights[4] = 0.032458497623198080L;
      _points[5][0] = 0.050547228317030975L; _points[5][1] = 0.898905543365938049L;  _weights[5] = 0.032458497623198080L;
      _points[6][0] = 0.898905543365938049L; _points[6][1] = 0.050547228317030975L;  _weights[6] = 0.032458497623198080L;
      _points[7][0] = 0.459292588292723156L; _points[7][1] = 0.459292588292723156L;  _weights[7] = 0.095091634267284625L;
      _points[8][0] = 0.459292588292723156L; _points[8][1] = 0.081414823414553688L;  _weights[8] = 0.095091634267284625L;
      _points[9][0] = 0.081414823414553688L; _points[9][1] = 0.459292588292723156L;  _weights[9] = 0.095091634267284625L;
      _points[10][0] = 0.263112829634638113L; _points[10][1] = 0.008394777409957605L;  _weights[10] = 0.027230314174434994L;
      _points[11][0] = 0.263112829634638113L; _points[11][1] = 0.728492392955404281L;  _weights[11] = 0.027230314174434994L;
      _points[12][0] = 0.008394777409957605L; _points[12][1] = 0.263112829634638113L;  _weights[12] = 0.027230314174434994L;
      _points[13][0] = 0.008394777409957605L; _points[13][1] = 0.728492392955404281L;  _weights[13] = 0.027230314174434994L;
      _points[14][0] = 0.728492392955404281L; _points[14][1] = 0.263112829634638113L;  _weights[14] = 0.027230314174434994L;
      _points[15][0] = 0.728492392955404281L; _points[15][1] = 0.008394777409957605L;  _weights[15] = 0.027230314174434994L;
    }
    break;

    case 9:
    {
      _n_points = 19;
      _points[0][0] = 0.333333333333333333L; _points[0][1] = 0.333333333333333333L;  _weights[0] = 0.097135796282798834L;
      _points[1][0] = 0.489682519198737628L; _points[1][1] = 0.489682519198737628L;  _weights[1] = 0.031334700227139071L;
      _points[2][0] = 0.489682519198737628L; _points[2][1] = 0.020634961602524744L;  _weights[2] = 0.031334700227139071L;
      _points[3][0] = 0.020634961602524744L; _points[3][1] = 0.489682519198737628L;  _weights[3] = 0.031334700227139071L;
      _points[4][0] = 0.044729513394452710L; _points[4][1] = 0.044729513394452710L;  _weights[4] = 0.025577675658698031L;
      _points[5][0] = 0.044729513394452710L; _points[5][1] = 0.910540973211094580L;  _weights[5] = 0.025577675658698031L;
      _points[6][0] = 0.910540973211094580L; _points[6][1] = 0.044729513394452710L;  _weights[6] = 0.025577675658698031L;
      _points[7][0] = 0.437089591492936637L; _points[7][1] = 0.437089591492936637L;  _weights[7] = 0.077827541004774279L;
      _points[8][0] = 0.437089591492936637L; _points[8][1] = 0.125820817014126725L;  _weights[8] = 0.077827541004774279L;
      _points[9][0] = 0.125820817014126725L; _points[9][1] = 0.437089591492936637L;  _weights[9] = 0.077827541004774279L;
      _points[10][0] = 0.188203535619032730L; _points[10][1] = 0.188203535619032730L;  _weights[10] = 0.079647738927210253L;
      _points[11][0] = 0.188203535619032730L; _points[11][1] = 0.623592928761934540L;  _weights[11] = 0.079647738927210253L;
      _points[12][0] = 0.623592928761934540L; _points[12][1] = 0.188203535619032730L;  _weights[12] = 0.079647738927210253L;
      _points[13][0] = 0.741198598784498021L; _points[13][1] = 0.221962989160765696L;  _weights[13] = 0.043283539377289377L;
      _points[14][0] = 0.741198598784498021L; _points[14][1] = 0.036838412054736284L;  _weights[14] = 0.043283539377289377L;
      _points[15][0] = 0.221962989160765696L; _points[15][1] = 0.741198598784498021L;  _weights[15] = 0.043283539377289377L;
      _points[16][0] = 0.221962989160765696L; _points[16][1] = 0.036838412054736284L;  _weights[16] = 0.043283539377289377L;
      _points[17][0] = 0.036838412054736284L; _points[17][1] = 0.741198598784498021L;  _weights[17] = 0.043283539377289377L;
      _points[18][0] = 0.036838412054736284L; _points[18][1] = 0.221962989160765696L;  _weights[18] = 0.043283539377289377L;

    }
    break;

    case 10:
    {
      _n_points = 25;
      _points[0][0] = 0.333333333333333333L; _points[0][1] = 0.333333333333333333L;  _weights[0] = 0.080937428797622880L;
      _points[1][0] = 0.427273178846775538L; _points[1][1] = 0.427273178846775538L;  _weights[1] = 0.077298588002963122L;
      _points[2][0] = 0.427273178846775538L; _points[2][1] = 0.145453642306448924L;  _weights[2] = 0.077298588002963122L;
      _points[3][0] = 0.145453642306448924L; _points[3][1] = 0.427273178846775538L;  _weights[3] = 0.077298588002963122L;
      _points[4][0] = 0.183099222448675021L; _points[4][1] = 0.183099222448675021L;  _weights[4] = 0.078457638612371731L;
      _points[5][0] = 0.183099222448675021L; _points[5][1] = 0.633801555102649959L;  _weights[5] = 0.078457638612371731L;
      _points[6][0] = 0.633801555102649959L; _points[6][1] = 0.183099222448675021L;  _weights[6] = 0.078457638612371731L;
      _points[7][0] = 0.490434019701130587L; _points[7][1] = 0.490434019701130587L;  _weights[7] = 0.017469167995929487L;
      _points[8][0] = 0.490434019701130587L; _points[8][1] = 0.019131960597738825L;  _weights[8] = 0.017469167995929487L;
      _points[9][0] = 0.019131960597738825L; _points[9][1] = 0.490434019701130587L;  _weights[9] = 0.017469167995929487L;
      _points[10][0] = 0.012572445551580533L; _points[10][1] = 0.012572445551580533L;  _weights[10] = 0.004292374184832828L;
      _points[11][0] = 0.012572445551580533L; _points[11][1] = 0.974855108896838935L;  _weights[11] = 0.004292374184832828L;
      _points[12][0] = 0.974855108896838935L; _points[12][1] = 0.012572445551580533L;  _weights[12] = 0.004292374184832828L;
      _points[13][0] = 0.654268667920066141L; _points[13][1] = 0.308046001685247706L;  _weights[13] = 0.037468858210467643L;
      _points[14][0] = 0.654268667920066141L; _points[14][1] = 0.037685330394686154L;  _weights[14] = 0.037468858210467643L;
      _points[15][0] = 0.308046001685247706L; _points[15][1] = 0.654268667920066141L;  _weights[15] = 0.037468858210467643L;
      _points[16][0] = 0.308046001685247706L; _points[16][1] = 0.037685330394686154L;  _weights[16] = 0.037468858210467643L;
      _points[17][0] = 0.037685330394686154L; _points[17][1] = 0.654268667920066141L;  _weights[17] = 0.037468858210467643L;
      _points[18][0] = 0.037685330394686154L; _points[18][1] = 0.308046001685247706L;  _weights[18] = 0.037468858210467643L;
      _points[19][0] = 0.122804577068559273L; _points[19][1] = 0.033371833739304788L;  _weights[19] = 0.026949352591879960L;
      _points[20][0] = 0.122804577068559273L; _points[20][1] = 0.843823589192135939L;  _weights[20] = 0.026949352591879960L;
      _points[21][0] = 0.033371833739304788L; _points[21][1] = 0.122804577068559273L;  _weights[21] = 0.026949352591879960L;
      _points[22][0] = 0.033371833739304788L; _points[22][1] = 0.843823589192135939L;  _weights[22] = 0.026949352591879960L;
      _points[23][0] = 0.843823589192135939L; _points[23][1] = 0.122804577068559273L;  _weights[23] = 0.026949352591879960L;
      _points[24][0] = 0.843823589192135939L; _points[24][1] = 0.033371833739304788L;  _weights[24] = 0.026949352591879960L;
    }
    break;


    default:
    {
      FEPIC_CHECK(false, "invalid or not supported quadrature order", std::invalid_argument);
    }

  }

  for (int i = 0; i < _n_points; ++i)
    _weights[i] /= 2.0L;

}

template<>
void Quadrature_TETRAHEDRON::setOrder(int n)
{

  switch (n)
  {
    case 0 ... 1:
    {
      _n_points = 1;
      _points[0][0] = 0.25L; _points[0][1] = 0.25L; _points[0][2] = 0.25L; _weights[0] = 1.000000000000000000L;
    }
    break;

    case 2:
    {
      _n_points = 4;
      _points[0][0] = 0.138196601125010515L; _points[0][1] = 0.138196601125010515L; _points[0][2] = 0.138196601125010515L;  _weights[0] = 0.250000000000000000L;
      _points[1][0] = 0.138196601125010515L; _points[1][1] = 0.138196601125010515L; _points[1][2] = 0.585410196624968454L;  _weights[1] = 0.250000000000000000L;
      _points[2][0] = 0.138196601125010515L; _points[2][1] = 0.585410196624968454L; _points[2][2] = 0.138196601125010515L;  _weights[2] = 0.250000000000000000L;
      _points[3][0] = 0.585410196624968454L; _points[3][1] = 0.138196601125010515L; _points[3][2] = 0.138196601125010515L;  _weights[3] = 0.250000000000000000L;
    }
    break;

    case 3:
    {
      _n_points = 8;
      _points[0][0] = 0.328054696711426647L; _points[0][1] = 0.328054696711426647L; _points[0][2] = 0.328054696711426647L;  _weights[0] = 0.138527966511862142L;
      _points[1][0] = 0.328054696711426647L; _points[1][1] = 0.328054696711426647L; _points[1][2] = 0.015835909865720058L;  _weights[1] = 0.138527966511862142L;
      _points[2][0] = 0.328054696711426647L; _points[2][1] = 0.015835909865720058L; _points[2][2] = 0.328054696711426647L;  _weights[2] = 0.138527966511862142L;
      _points[3][0] = 0.015835909865720058L; _points[3][1] = 0.328054696711426647L; _points[3][2] = 0.328054696711426647L;  _weights[3] = 0.138527966511862142L;
      _points[4][0] = 0.106952273932930683L; _points[4][1] = 0.106952273932930683L; _points[4][2] = 0.106952273932930683L;  _weights[4] = 0.111472033488137858L;
      _points[5][0] = 0.106952273932930683L; _points[5][1] = 0.106952273932930683L; _points[5][2] = 0.679143178201207952L;  _weights[5] = 0.111472033488137858L;
      _points[6][0] = 0.106952273932930683L; _points[6][1] = 0.679143178201207952L; _points[6][2] = 0.106952273932930683L;  _weights[6] = 0.111472033488137858L;
      _points[7][0] = 0.679143178201207952L; _points[7][1] = 0.106952273932930683L; _points[7][2] = 0.106952273932930683L;  _weights[7] = 0.111472033488137858L;
    }
    break;

    case 4 ... 5:
    {
      _n_points = 14;
      _points[0][0] = 0.310885919263300610L; _points[0][1] = 0.310885919263300610L; _points[0][2] = 0.310885919263300610L;  _weights[0] = 0.112687925718015851L;
      _points[1][0] = 0.310885919263300610L; _points[1][1] = 0.310885919263300610L; _points[1][2] = 0.067342242210098171L;  _weights[1] = 0.112687925718015851L;
      _points[2][0] = 0.310885919263300610L; _points[2][1] = 0.067342242210098171L; _points[2][2] = 0.310885919263300610L;  _weights[2] = 0.112687925718015851L;
      _points[3][0] = 0.067342242210098171L; _points[3][1] = 0.310885919263300610L; _points[3][2] = 0.310885919263300610L;  _weights[3] = 0.112687925718015851L;
      _points[4][0] = 0.092735250310891226L; _points[4][1] = 0.092735250310891226L; _points[4][2] = 0.092735250310891226L;  _weights[4] = 0.073493043116361950L;
      _points[5][0] = 0.092735250310891226L; _points[5][1] = 0.092735250310891226L; _points[5][2] = 0.721794249067326321L;  _weights[5] = 0.073493043116361950L;
      _points[6][0] = 0.092735250310891226L; _points[6][1] = 0.721794249067326321L; _points[6][2] = 0.092735250310891226L;  _weights[6] = 0.073493043116361950L;
      _points[7][0] = 0.721794249067326321L; _points[7][1] = 0.092735250310891226L; _points[7][2] = 0.092735250310891226L;  _weights[7] = 0.073493043116361950L;
      _points[8][0] = 0.045503704125649649L; _points[8][1] = 0.045503704125649649L; _points[8][2] = 0.454496295874350350L;  _weights[8] = 0.042546020777081466L;
      _points[9][0] = 0.045503704125649649L; _points[9][1] = 0.454496295874350350L; _points[9][2] = 0.045503704125649649L;  _weights[9] = 0.042546020777081466L;
      _points[10][0] = 0.045503704125649649L; _points[10][1] = 0.454496295874350350L; _points[10][2] = 0.454496295874350350L;  _weights[10] = 0.042546020777081466L;
      _points[11][0] = 0.454496295874350350L; _points[11][1] = 0.454496295874350350L; _points[11][2] = 0.045503704125649649L;  _weights[11] = 0.042546020777081466L;
      _points[12][0] = 0.454496295874350350L; _points[12][1] = 0.045503704125649649L; _points[12][2] = 0.454496295874350350L;  _weights[12] = 0.042546020777081466L;
      _points[13][0] = 0.454496295874350350L; _points[13][1] = 0.045503704125649649L; _points[13][2] = 0.045503704125649649L;  _weights[13] = 0.042546020777081466L;
    }
    break;

    case 6:
    {
      _n_points = 24;
      _points[0][0] = 0.214602871259152029L; _points[0][1] = 0.214602871259152029L; _points[0][2] = 0.214602871259152029L;  _weights[0] = 0.039922750258167492L;
      _points[1][0] = 0.214602871259152029L; _points[1][1] = 0.214602871259152029L; _points[1][2] = 0.356191386222543912L;  _weights[1] = 0.039922750258167492L;
      _points[2][0] = 0.214602871259152029L; _points[2][1] = 0.356191386222543912L; _points[2][2] = 0.214602871259152029L;  _weights[2] = 0.039922750258167492L;
      _points[3][0] = 0.356191386222543912L; _points[3][1] = 0.214602871259152029L; _points[3][2] = 0.214602871259152029L;  _weights[3] = 0.039922750258167492L;
      _points[4][0] = 0.040673958534611353L; _points[4][1] = 0.040673958534611353L; _points[4][2] = 0.040673958534611353L;  _weights[4] = 0.010077211055320643L;
      _points[5][0] = 0.040673958534611353L; _points[5][1] = 0.040673958534611353L; _points[5][2] = 0.877978124396165941L;  _weights[5] = 0.010077211055320643L;
      _points[6][0] = 0.040673958534611353L; _points[6][1] = 0.877978124396165941L; _points[6][2] = 0.040673958534611353L;  _weights[6] = 0.010077211055320643L;
      _points[7][0] = 0.877978124396165941L; _points[7][1] = 0.040673958534611353L; _points[7][2] = 0.040673958534611353L;  _weights[7] = 0.010077211055320643L;
      _points[8][0] = 0.322337890142275510L; _points[8][1] = 0.322337890142275510L; _points[8][2] = 0.322337890142275510L;  _weights[8] = 0.055357181543654722L;
      _points[9][0] = 0.322337890142275510L; _points[9][1] = 0.322337890142275510L; _points[9][2] = 0.032986329573173469L;  _weights[9] = 0.055357181543654722L;
      _points[10][0] = 0.322337890142275510L; _points[10][1] = 0.032986329573173469L; _points[10][2] = 0.322337890142275510L;  _weights[10] = 0.055357181543654722L;
      _points[11][0] = 0.032986329573173469L; _points[11][1] = 0.322337890142275510L; _points[11][2] = 0.322337890142275510L;  _weights[11] = 0.055357181543654722L;
      _points[12][0] = 0.063661001875017525L; _points[12][1] = 0.063661001875017525L; _points[12][2] = 0.603005664791649141L;  _weights[12] = 0.048214285714285714L;
      _points[13][0] = 0.063661001875017525L; _points[13][1] = 0.063661001875017525L; _points[13][2] = 0.269672331458315808L;  _weights[13] = 0.048214285714285714L;
      _points[14][0] = 0.063661001875017525L; _points[14][1] = 0.603005664791649141L; _points[14][2] = 0.063661001875017525L;  _weights[14] = 0.048214285714285714L;
      _points[15][0] = 0.063661001875017525L; _points[15][1] = 0.603005664791649141L; _points[15][2] = 0.269672331458315808L;  _weights[15] = 0.048214285714285714L;
      _points[16][0] = 0.063661001875017525L; _points[16][1] = 0.269672331458315808L; _points[16][2] = 0.063661001875017525L;  _weights[16] = 0.048214285714285714L;
      _points[17][0] = 0.063661001875017525L; _points[17][1] = 0.269672331458315808L; _points[17][2] = 0.603005664791649141L;  _weights[17] = 0.048214285714285714L;
      _points[18][0] = 0.603005664791649141L; _points[18][1] = 0.063661001875017525L; _points[18][2] = 0.063661001875017525L;  _weights[18] = 0.048214285714285714L;
      _points[19][0] = 0.603005664791649141L; _points[19][1] = 0.063661001875017525L; _points[19][2] = 0.269672331458315808L;  _weights[19] = 0.048214285714285714L;
      _points[20][0] = 0.603005664791649141L; _points[20][1] = 0.269672331458315808L; _points[20][2] = 0.063661001875017525L;  _weights[20] = 0.048214285714285714L;
      _points[21][0] = 0.269672331458315808L; _points[21][1] = 0.063661001875017525L; _points[21][2] = 0.063661001875017525L;  _weights[21] = 0.048214285714285714L;
      _points[22][0] = 0.269672331458315808L; _points[22][1] = 0.063661001875017525L; _points[22][2] = 0.603005664791649141L;  _weights[22] = 0.048214285714285714L;
      _points[23][0] = 0.269672331458315808L; _points[23][1] = 0.603005664791649141L; _points[23][2] = 0.063661001875017525L;  _weights[23] = 0.048214285714285714L;
    }
    break;

    case 7:
    {
      _n_points = 36;
      _points[0][0] = 0.040610707192945272L; _points[0][1] = 0.040610707192945272L; _points[0][2] = 0.040610707192945272L;  _weights[0] = 0.006183415839458518L;
      _points[1][0] = 0.040610707192945272L; _points[1][1] = 0.040610707192945272L; _points[1][2] = 0.878167878421164183L;  _weights[1] = 0.006183415839458518L;
      _points[2][0] = 0.040610707192945272L; _points[2][1] = 0.878167878421164183L; _points[2][2] = 0.040610707192945272L;  _weights[2] = 0.006183415839458518L;
      _points[3][0] = 0.878167878421164183L; _points[3][1] = 0.040610707192945272L; _points[3][2] = 0.040610707192945272L;  _weights[3] = 0.006183415839458518L;
      _points[4][0] = 0.178752202696498476L; _points[4][1] = 0.178752202696498476L; _points[4][2] = 0.178752202696498476L;  _weights[4] = 0.078514650273872359L;
      _points[5][0] = 0.178752202696498476L; _points[5][1] = 0.178752202696498476L; _points[5][2] = 0.463743391910504572L;  _weights[5] = 0.078514650273872359L;
      _points[6][0] = 0.178752202696498476L; _points[6][1] = 0.463743391910504572L; _points[6][2] = 0.178752202696498476L;  _weights[6] = 0.078514650273872359L;
      _points[7][0] = 0.463743391910504572L; _points[7][1] = 0.178752202696498476L; _points[7][2] = 0.178752202696498476L;  _weights[7] = 0.078514650273872359L;
      _points[8][0] = 0.324949590537337334L; _points[8][1] = 0.324949590537337334L; _points[8][2] = 0.324949590537337334L;  _weights[8] = 0.044739577614322479L;
      _points[9][0] = 0.324949590537337334L; _points[9][1] = 0.324949590537337334L; _points[9][2] = 0.025151228387987999L;  _weights[9] = 0.044739577614322479L;
      _points[10][0] = 0.324949590537337334L; _points[10][1] = 0.025151228387987999L; _points[10][2] = 0.324949590537337334L;  _weights[10] = 0.044739577614322479L;
      _points[11][0] = 0.025151228387987999L; _points[11][1] = 0.324949590537337334L; _points[11][2] = 0.324949590537337334L;  _weights[11] = 0.044739577614322479L;
      _points[12][0] = 0.134077737972161192L; _points[12][1] = 0.134077737972161192L; _points[12][2] = 0.727012507009317100L;  _weights[12] = 0.012165144592291294L;
      _points[13][0] = 0.134077737972161192L; _points[13][1] = 0.134077737972161192L; _points[13][2] = 0.004832017046360516L;  _weights[13] = 0.012165144592291294L;
      _points[14][0] = 0.134077737972161192L; _points[14][1] = 0.727012507009317100L; _points[14][2] = 0.134077737972161192L;  _weights[14] = 0.012165144592291294L;
      _points[15][0] = 0.134077737972161192L; _points[15][1] = 0.727012507009317100L; _points[15][2] = 0.004832017046360516L;  _weights[15] = 0.012165144592291294L;
      _points[16][0] = 0.134077737972161192L; _points[16][1] = 0.004832017046360516L; _points[16][2] = 0.134077737972161192L;  _weights[16] = 0.012165144592291294L;
      _points[17][0] = 0.134077737972161192L; _points[17][1] = 0.004832017046360516L; _points[17][2] = 0.727012507009317100L;  _weights[17] = 0.012165144592291294L;
      _points[18][0] = 0.727012507009317100L; _points[18][1] = 0.134077737972161192L; _points[18][2] = 0.134077737972161192L;  _weights[18] = 0.012165144592291294L;
      _points[19][0] = 0.727012507009317100L; _points[19][1] = 0.134077737972161192L; _points[19][2] = 0.004832017046360516L;  _weights[19] = 0.012165144592291294L;
      _points[20][0] = 0.727012507009317100L; _points[20][1] = 0.004832017046360516L; _points[20][2] = 0.134077737972161192L;  _weights[20] = 0.012165144592291294L;
      _points[21][0] = 0.004832017046360516L; _points[21][1] = 0.134077737972161192L; _points[21][2] = 0.134077737972161192L;  _weights[21] = 0.012165144592291294L;
      _points[22][0] = 0.004832017046360516L; _points[22][1] = 0.134077737972161192L; _points[22][2] = 0.727012507009317100L;  _weights[22] = 0.012165144592291294L;
      _points[23][0] = 0.004832017046360516L; _points[23][1] = 0.727012507009317100L; _points[23][2] = 0.134077737972161192L;  _weights[23] = 0.012165144592291294L;
      _points[24][0] = 0.056027540459728477L; _points[24][1] = 0.056027540459728477L; _points[24][2] = 0.326574099866404958L;  _weights[24] = 0.028022307498490921L;
      _points[25][0] = 0.056027540459728477L; _points[25][1] = 0.056027540459728477L; _points[25][2] = 0.561370819214138088L;  _weights[25] = 0.028022307498490921L;
      _points[26][0] = 0.056027540459728477L; _points[26][1] = 0.326574099866404958L; _points[26][2] = 0.056027540459728477L;  _weights[26] = 0.028022307498490921L;
      _points[27][0] = 0.056027540459728477L; _points[27][1] = 0.326574099866404958L; _points[27][2] = 0.561370819214138088L;  _weights[27] = 0.028022307498490921L;
      _points[28][0] = 0.056027540459728477L; _points[28][1] = 0.561370819214138088L; _points[28][2] = 0.056027540459728477L;  _weights[28] = 0.028022307498490921L;
      _points[29][0] = 0.056027540459728477L; _points[29][1] = 0.561370819214138088L; _points[29][2] = 0.326574099866404958L;  _weights[29] = 0.028022307498490921L;
      _points[30][0] = 0.326574099866404958L; _points[30][1] = 0.056027540459728477L; _points[30][2] = 0.056027540459728477L;  _weights[30] = 0.028022307498490921L;
      _points[31][0] = 0.326574099866404958L; _points[31][1] = 0.056027540459728477L; _points[31][2] = 0.561370819214138088L;  _weights[31] = 0.028022307498490921L;
      _points[32][0] = 0.326574099866404958L; _points[32][1] = 0.561370819214138088L; _points[32][2] = 0.056027540459728477L;  _weights[32] = 0.028022307498490921L;
      _points[33][0] = 0.561370819214138088L; _points[33][1] = 0.056027540459728477L; _points[33][2] = 0.056027540459728477L;  _weights[33] = 0.028022307498490921L;
      _points[34][0] = 0.561370819214138088L; _points[34][1] = 0.056027540459728477L; _points[34][2] = 0.326574099866404958L;  _weights[34] = 0.028022307498490921L;
      _points[35][0] = 0.561370819214138088L; _points[35][1] = 0.326574099866404958L; _points[35][2] = 0.056027540459728477L;  _weights[35] = 0.028022307498490921L;
    }
    break;

    case 8:
    {
      _n_points = 46;
      _points[0][0] = 0.039675423070389901L; _points[0][1] = 0.039675423070389901L; _points[0][2] = 0.039675423070389901L;  _weights[0] = 0.006397147779902321L;
      _points[1][0] = 0.039675423070389901L; _points[1][1] = 0.039675423070389901L; _points[1][2] = 0.880973730788830296L;  _weights[1] = 0.006397147779902321L;
      _points[2][0] = 0.039675423070389901L; _points[2][1] = 0.880973730788830296L; _points[2][2] = 0.039675423070389901L;  _weights[2] = 0.006397147779902321L;
      _points[3][0] = 0.880973730788830296L; _points[3][1] = 0.039675423070389901L; _points[3][2] = 0.039675423070389901L;  _weights[3] = 0.006397147779902321L;
      _points[4][0] = 0.314487800698096314L; _points[4][1] = 0.314487800698096314L; _points[4][2] = 0.314487800698096314L;  _weights[4] = 0.040190448020966172L;
      _points[5][0] = 0.314487800698096314L; _points[5][1] = 0.314487800698096314L; _points[5][2] = 0.056536597905711059L;  _weights[5] = 0.040190448020966172L;
      _points[6][0] = 0.314487800698096314L; _points[6][1] = 0.056536597905711059L; _points[6][2] = 0.314487800698096314L;  _weights[6] = 0.040190448020966172L;
      _points[7][0] = 0.056536597905711059L; _points[7][1] = 0.314487800698096314L; _points[7][2] = 0.314487800698096314L;  _weights[7] = 0.040190448020966172L;
      _points[8][0] = 0.101986693062703300L; _points[8][1] = 0.101986693062703300L; _points[8][2] = 0.101986693062703300L;  _weights[8] = 0.024307975504770321L;
      _points[9][0] = 0.101986693062703300L; _points[9][1] = 0.101986693062703300L; _points[9][2] = 0.694039920811890100L;  _weights[9] = 0.024307975504770321L;
      _points[10][0] = 0.101986693062703300L; _points[10][1] = 0.694039920811890100L; _points[10][2] = 0.101986693062703300L;  _weights[10] = 0.024307975504770321L;
      _points[11][0] = 0.694039920811890100L; _points[11][1] = 0.101986693062703300L; _points[11][2] = 0.101986693062703300L;  _weights[11] = 0.024307975504770321L;
      _points[12][0] = 0.184203696949191512L; _points[12][1] = 0.184203696949191512L; _points[12][2] = 0.184203696949191512L;  _weights[12] = 0.054858892413697440L;
      _points[13][0] = 0.184203696949191512L; _points[13][1] = 0.184203696949191512L; _points[13][2] = 0.447388909152425463L;  _weights[13] = 0.054858892413697440L;
      _points[14][0] = 0.184203696949191512L; _points[14][1] = 0.447388909152425463L; _points[14][2] = 0.184203696949191512L;  _weights[14] = 0.054858892413697440L;
      _points[15][0] = 0.447388909152425463L; _points[15][1] = 0.184203696949191512L; _points[15][2] = 0.184203696949191512L;  _weights[15] = 0.054858892413697440L;
      _points[16][0] = 0.063436287754539892L; _points[16][1] = 0.063436287754539892L; _points[16][2] = 0.436563712245460108L;  _weights[16] = 0.035719612234099182L;
      _points[17][0] = 0.063436287754539892L; _points[17][1] = 0.436563712245460108L; _points[17][2] = 0.063436287754539892L;  _weights[17] = 0.035719612234099182L;
      _points[18][0] = 0.063436287754539892L; _points[18][1] = 0.436563712245460108L; _points[18][2] = 0.436563712245460108L;  _weights[18] = 0.035719612234099182L;
      _points[19][0] = 0.436563712245460108L; _points[19][1] = 0.436563712245460108L; _points[19][2] = 0.063436287754539892L;  _weights[19] = 0.035719612234099182L;
      _points[20][0] = 0.436563712245460108L; _points[20][1] = 0.063436287754539892L; _points[20][2] = 0.436563712245460108L;  _weights[20] = 0.035719612234099182L;
      _points[21][0] = 0.436563712245460108L; _points[21][1] = 0.063436287754539892L; _points[21][2] = 0.063436287754539892L;  _weights[21] = 0.035719612234099182L;
      _points[22][0] = 0.021690162067728005L; _points[22][1] = 0.021690162067728005L; _points[22][2] = 0.719931922039465936L;  _weights[22] = 0.007183190697852539L;
      _points[23][0] = 0.021690162067728005L; _points[23][1] = 0.021690162067728005L; _points[23][2] = 0.236687753825078055L;  _weights[23] = 0.007183190697852539L;
      _points[24][0] = 0.021690162067728005L; _points[24][1] = 0.719931922039465936L; _points[24][2] = 0.021690162067728005L;  _weights[24] = 0.007183190697852539L;
      _points[25][0] = 0.021690162067728005L; _points[25][1] = 0.719931922039465936L; _points[25][2] = 0.236687753825078055L;  _weights[25] = 0.007183190697852539L;
      _points[26][0] = 0.021690162067728005L; _points[26][1] = 0.236687753825078055L; _points[26][2] = 0.021690162067728005L;  _weights[26] = 0.007183190697852539L;
      _points[27][0] = 0.021690162067728005L; _points[27][1] = 0.236687753825078055L; _points[27][2] = 0.719931922039465936L;  _weights[27] = 0.007183190697852539L;
      _points[28][0] = 0.719931922039465936L; _points[28][1] = 0.021690162067728005L; _points[28][2] = 0.021690162067728005L;  _weights[28] = 0.007183190697852539L;
      _points[29][0] = 0.719931922039465936L; _points[29][1] = 0.021690162067728005L; _points[29][2] = 0.236687753825078055L;  _weights[29] = 0.007183190697852539L;
      _points[30][0] = 0.719931922039465936L; _points[30][1] = 0.236687753825078055L; _points[30][2] = 0.021690162067728005L;  _weights[30] = 0.007183190697852539L;
      _points[31][0] = 0.236687753825078055L; _points[31][1] = 0.021690162067728005L; _points[31][2] = 0.021690162067728005L;  _weights[31] = 0.007183190697852539L;
      _points[32][0] = 0.236687753825078055L; _points[32][1] = 0.021690162067728005L; _points[32][2] = 0.719931922039465936L;  _weights[32] = 0.007183190697852539L;
      _points[33][0] = 0.236687753825078055L; _points[33][1] = 0.719931922039465936L; _points[33][2] = 0.021690162067728005L;  _weights[33] = 0.007183190697852539L;
      _points[34][0] = 0.204480080636795714L; _points[34][1] = 0.204480080636795714L; _points[34][2] = 0.580577190128809224L;  _weights[34] = 0.016372181945319118L;
      _points[35][0] = 0.204480080636795714L; _points[35][1] = 0.204480080636795714L; _points[35][2] = 0.010462648597599347L;  _weights[35] = 0.016372181945319118L;
      _points[36][0] = 0.204480080636795714L; _points[36][1] = 0.580577190128809224L; _points[36][2] = 0.204480080636795714L;  _weights[36] = 0.016372181945319118L;
      _points[37][0] = 0.204480080636795714L; _points[37][1] = 0.580577190128809224L; _points[37][2] = 0.010462648597599347L;  _weights[37] = 0.016372181945319118L;
      _points[38][0] = 0.204480080636795714L; _points[38][1] = 0.010462648597599347L; _points[38][2] = 0.204480080636795714L;  _weights[38] = 0.016372181945319118L;
      _points[39][0] = 0.204480080636795714L; _points[39][1] = 0.010462648597599347L; _points[39][2] = 0.580577190128809224L;  _weights[39] = 0.016372181945319118L;
      _points[40][0] = 0.580577190128809224L; _points[40][1] = 0.204480080636795714L; _points[40][2] = 0.204480080636795714L;  _weights[40] = 0.016372181945319118L;
      _points[41][0] = 0.580577190128809224L; _points[41][1] = 0.204480080636795714L; _points[41][2] = 0.010462648597599347L;  _weights[41] = 0.016372181945319118L;
      _points[42][0] = 0.580577190128809224L; _points[42][1] = 0.010462648597599347L; _points[42][2] = 0.204480080636795714L;  _weights[42] = 0.016372181945319118L;
      _points[43][0] = 0.010462648597599347L; _points[43][1] = 0.204480080636795714L; _points[43][2] = 0.204480080636795714L;  _weights[43] = 0.016372181945319118L;
      _points[44][0] = 0.010462648597599347L; _points[44][1] = 0.204480080636795714L; _points[44][2] = 0.580577190128809224L;  _weights[44] = 0.016372181945319118L;
      _points[45][0] = 0.010462648597599347L; _points[45][1] = 0.580577190128809224L; _points[45][2] = 0.204480080636795714L;  _weights[45] = 0.016372181945319118L;
    }
    break;

    default:
    {
      FEPIC_CHECK(false, "invalid or not supported quadrature order", std::invalid_argument);
    }

    }

  for (int i = 0; i < _n_points; ++i)
    _weights[i] /= 6.0L;
    
}



//template class Quadrature_EDGE;
//template class Quadrature_QUADRANGLE;
//template class Quadrature_HEXAHEDRON;
//template class Quadrature_TRIANGLE;
//template class Quadrature_TETRAHEDRON;
